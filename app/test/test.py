import asyncio
from time import sleep
import httpx

test_coordinates = [
    # 대전광역시 (3개)
    {"name": "중구", "lat": 36.3257, "lng": 127.4212},
    {"name": "동구", "lat": 36.3118, "lng": 127.4548},
    {"name": "서구", "lat": 36.3556, "lng": 127.3839},
    
    # 서울특별시 (25개)
    {"name": "종로구", "lat": 37.5735, "lng": 126.9788},
    {"name": "관악구", "lat": 37.4781, "lng": 126.9515},
    {"name": "송파구", "lat": 37.5145, "lng": 127.1059},
    {"name": "중구", "lat": 37.5636, "lng": 126.9977},
    {"name": "용산구", "lat": 37.5326, "lng": 126.9906},
    {"name": "성동구", "lat": 37.5634, "lng": 127.0371},
    {"name": "광진구", "lat": 37.5385, "lng": 127.0823},
    {"name": "동대문구", "lat": 37.5744, "lng": 127.0396},
    {"name": "중랑구", "lat": 37.6066, "lng": 127.0925},
    {"name": "성북구", "lat": 37.5894, "lng": 127.0167},
    {"name": "강북구", "lat": 37.6369, "lng": 127.0257},
    {"name": "도봉구", "lat": 37.6688, "lng": 127.0471},
    {"name": "노원구", "lat": 37.6543, "lng": 127.0568},
    {"name": "은평구", "lat": 37.6176, "lng": 126.9227},
    {"name": "서대문구", "lat": 37.5791, "lng": 126.9368},
    {"name": "마포구", "lat": 37.5663, "lng": 126.9019},
    {"name": "양천구", "lat": 37.5169, "lng": 126.8664},
    {"name": "강서구", "lat": 37.5509, "lng": 126.8495},
    {"name": "구로구", "lat": 37.4955, "lng": 126.8874},
    {"name": "금천구", "lat": 37.4519, "lng": 126.8954},
    {"name": "영등포구", "lat": 37.5264, "lng": 126.8962},
    {"name": "동작구", "lat": 37.5124, "lng": 126.9393},
    {"name": "서초구", "lat": 37.4837, "lng": 127.0324},
    {"name": "강남구", "lat": 37.5173, "lng": 127.0473},
    {"name": "강동구", "lat": 37.5301, "lng": 127.1238},
    
    # 부산광역시 (8개)
    {"name": "중구", "lat": 35.1040, "lng": 129.0325},
    {"name": "서구", "lat": 35.0978, "lng": 129.0240},
    {"name": "동구", "lat": 35.1295, "lng": 129.0454},
    {"name": "영도구", "lat": 35.0906, "lng": 129.0682},
    {"name": "부산진구", "lat": 35.1625, "lng": 129.0532},
    {"name": "동래구", "lat": 35.2049, "lng": 129.0837},
    {"name": "남구", "lat": 35.1368, "lng": 129.0841},
    {"name": "해운대구", "lat": 35.1631, "lng": 129.1640},
    
    # 대구광역시 (4개)
    {"name": "중구", "lat": 35.8715, "lng": 128.6014},
    {"name": "동구", "lat": 35.8869, "lng": 128.6357},
    {"name": "서구", "lat": 35.8719, "lng": 128.5593},
    {"name": "수성구", "lat": 35.8583, "lng": 128.6311},
    
    # 인천광역시 (5개)
    {"name": "중구", "lat": 37.4739, "lng": 126.6210},
    {"name": "동구", "lat": 37.4739, "lng": 126.6431},
    {"name": "미추홀구", "lat": 37.4638, "lng": 126.6506},
    {"name": "연수구", "lat": 37.4106, "lng": 126.6783},
    {"name": "남동구", "lat": 37.4470, "lng": 126.7314},
    
    # 광주광역시 (3개)
    {"name": "동구", "lat": 35.1464, "lng": 126.9224},
    {"name": "서구", "lat": 35.1522, "lng": 126.8895},
    {"name": "남구", "lat": 35.1327, "lng": 126.9026},
    
    # 강원도 (6개)
    {"name": "춘천시", "lat": 37.8813, "lng": 127.7300},
    {"name": "원주시", "lat": 37.3422, "lng": 127.9202},
    {"name": "강릉시", "lat": 37.7519, "lng": 128.8761},
    {"name": "동해시", "lat": 37.5247, "lng": 129.1144},
    {"name": "태백시", "lat": 37.1640, "lng": 128.9856},
    {"name": "속초시", "lat": 38.2070, "lng": 128.5918},
    
    # 충청북도 (4개)
    {"name": "청주시", "lat": 36.6424, "lng": 127.4890},
    {"name": "충주시", "lat": 36.9910, "lng": 127.9259},
    {"name": "제천시", "lat": 37.1326, "lng": 128.1910},
    {"name": "음성군", "lat": 36.9436, "lng": 127.6869},
    
    # 충청남도 (6개)
    {"name": "천안시", "lat": 36.8151, "lng": 127.1139},
    {"name": "공주시", "lat": 36.4465, "lng": 127.1196},
    {"name": "보령시", "lat": 36.3331, "lng": 126.6127},
    {"name": "아산시", "lat": 36.7898, "lng": 127.0017},
    {"name": "서산시", "lat": 36.7848, "lng": 126.4503},
    {"name": "논산시", "lat": 36.1871, "lng": 127.0987},
    
    # 전라북도 (5개)
    {"name": "전주시", "lat": 35.8242, "lng": 127.1480},
    {"name": "군산시", "lat": 35.9674, "lng": 126.7368},
    {"name": "익산시", "lat": 35.9483, "lng": 126.9576},
    {"name": "정읍시", "lat": 35.5700, "lng": 126.8557},
    {"name": "남원시", "lat": 35.4164, "lng": 127.3906},
    
    # 전라남도 (7개)
    {"name": "목포시", "lat": 34.8118, "lng": 126.3922},
    {"name": "여수시", "lat": 34.7604, "lng": 127.6622},
    {"name": "순천시", "lat": 34.9507, "lng": 127.4872},
    {"name": "나주시", "lat": 35.0160, "lng": 126.7107},
    {"name": "광양시", "lat": 34.9757, "lng": 127.7000},
    {"name": "해남군", "lat": 34.5733, "lng": 126.5989},
    {"name": "완도군", "lat": 34.3109, "lng": 126.7552},
    
    # 경상북도 (8개)
    {"name": "포항시", "lat": 36.0190, "lng": 129.3435},
    {"name": "경주시", "lat": 35.8562, "lng": 129.2247},
    {"name": "김천시", "lat": 36.1396, "lng": 128.1137},
    {"name": "안동시", "lat": 36.5684, "lng": 128.7294},
    {"name": "구미시", "lat": 36.1196, "lng": 128.3441},
    {"name": "영주시", "lat": 36.8057, "lng": 128.6240},
    {"name": "영천시", "lat": 35.9733, "lng": 128.9386},
    {"name": "상주시", "lat": 36.4109, "lng": 128.1590},
    
    # 경상남도 (7개)
    {"name": "창원시", "lat": 35.2281, "lng": 128.6811},
    {"name": "진주시", "lat": 35.1800, "lng": 128.1076},
    {"name": "통영시", "lat": 34.8544, "lng": 128.4339},
    {"name": "사천시", "lat": 35.0036, "lng": 128.0645},
    {"name": "김해시", "lat": 35.2281, "lng": 128.8894},
    {"name": "밀양시", "lat": 35.5040, "lng": 128.7469},
    {"name": "거제시", "lat": 34.8806, "lng": 128.6217},
    
    # 제주특별자치도 (2개)
    {"name": "제주시", "lat": 33.4996, "lng": 126.5312},
    {"name": "서귀포시", "lat": 33.2541, "lng": 126.5601},
    
    # 세종특별자치시 (1개)
    {"name": "세종시", "lat": 36.4641, "lng": 127.2565},
]

async def test_walkability_current_api(nums: int = 5):
    """현재 산책 적합도 API 테스트"""
    base_url = "http://127.0.0.1:3500"
    
    async with httpx.AsyncClient() as client:
        for coord in test_coordinates[:nums]:
            try:
                params = {
                    "lat": coord["lat"],
                    "lon": coord["lng"],
                    "dog_size": "medium",
                    "sensitivities": "",
                    "air_quality_type": "korean"
                }
                print(params)
                response = await client.get(
                    f"{base_url}/api/v1/walkability/current",
                    params=params
                )
                print(f"\n{'='*50}")
                print(f"테스트 지역: {coord['name']}")
                print(f"위도: {coord['lat']}, 경도: {coord['lng']}")
                print(f"응답 상태코드: {response.status_code}")
                
                if response.status_code == 200:
                    # data = response.json()
                    print(f"성공! 응답 데이터:")
                    # print(f"{data}")
                else:
                    print(f"오류 응답: {response.text}")
                
                sleep(1)
            except Exception as e:
                print(f"에러 발생 - {coord['name']}: {str(e)}")

if __name__ == "__main__":
    print("API 테스트 시작...")
    print("1. 전체 좌표 테스트")
    print("2. 단일 좌표 테스트")
    
    choice = input("선택하세요 (1 또는 2): ")
    nums = input("테스트할 좌표 개수 (기본값 5개): ") or 5
    
    if choice == "1":
        asyncio.run(test_walkability_current_api(nums=int(nums)))
    else:
        print("잘못된 선택입니다.")